#!/usr/bin/env bash

# ==========
# Linux program installs with apt
# ==========
sudo apt -y install blueman curl ffmpeg nodejs npm tmux xclip zsh

chsh -s $(which zsh)

# ==========
# Manual installs
# ==========
echo "Installing Dropbox..."
wget "https://www.dropbox.com/download?dl=packages/ubuntu/dropbox_2019.01.31_amd64.deb"
sudo dpkg -i "dropbox_2019.01.31_amd64.deb"
rm "dropbox_2019.01.31_amd64.deb"

echo "Installing tpm..."
git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

echo "Installing Zplug..."
curl -sL --proto-redir -all,https https://raw.githubusercontent.com/zplug/installer/master/installer.zsh | zsh

echo "Installing miniconda..."
curl -sL https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh | bash

# ==========
# dotbot: dotfile bootstrapper
# ==========
set -e

CONFIG="install.conf.yaml"
DOTBOT_DIR="dotbot"

DOTBOT_BIN="bin/dotbot"
BASEDIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

cd "${BASEDIR}"
git -C "${DOTBOT_DIR}" submodule sync --quiet --recursive
git submodule update --init --recursive "${DOTBOT_DIR}"

"${BASEDIR}/${DOTBOT_DIR}/${DOTBOT_BIN}" -d "${BASEDIR}" -c "${CONFIG}" "${@}"

